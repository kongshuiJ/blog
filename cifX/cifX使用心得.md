<p><span style="font-size: 14pt;"><strong>一、注意事项：</strong></span></p>
<p>1.xChannelIORead()第一次读取到数据是空的。<br />2.系统安装cifX驱动之前一定先安装有uio模块和libpciaccess库；建议系统内核为3.X.X版本，测试版本为3.13.5；GCC为4.X.X，测试版本为4.6.3。<br />3.SYCON.net选择从站设备描述文件时建议通过扫描功能添加，因为手动配置的文件版本可能不匹配，导致网络通信无法开启。<br />4.默认的配置文件存储目录为"/opt/cifx"，再运行应用程序或者demo时，可以通过"/opt/cifx/cifXn.log"文件查看硬件加载配置文件的结果，n为硬件流水号。<br />5.三种配置文件名字不可更改，设备描述文件为&ldquo;device.conf&rdquo;，协议栈文件(EtherCAT)为"cifxecm.nxf"，网络配置文件为&ldquo;config.nxd&ldquo;。<br />6.SYCON.net扫描出的从站需要更换别名，格式：从站型号_从站类型_同类从站的序号_所有从站的序号&nbsp; 如： EL1004_DI_0_0。<br />7.首次安装好uio_netx模块，系统下一次开机并不会自动加载uio_netx模块，建议在"/etc/modules"中添加一行"uio_netx"使系统每次重启自动加载uio_netx模块。<br />8.EtherCAT主站协议栈是支持Hot Connect这个功能的，但是目前版本的SYCON.net不能支持Hot Connect的配置，需要使用ENI文件（该文件也是配置文件，是由EtherCAT Configurator生成，这个软件不是赫优讯的，是Beckhoff公司的）。也就是 使用ENI文件替换SYCON.net生成的config.nxd文件。<br />9.EL模块不支持热插拔的。</p>
<p>&nbsp;</p>
<p>更多关于安装cifX驱动的问题可以查看&ldquo;cifX Device Driver - Linux DRV 08 EN.pdf&rdquo;手册的第7章节。</p>
<p>&nbsp;</p>
<p><span style="font-size: 14pt;"><strong>二、应用问题：</strong></span></p>
<p><span style="color: #ff0000;">1.<span style="font-family: 宋体;">第一次</span>read<span style="font-family: 宋体;">必须过滤掉吗？</span></span></p>
<p class="15"><span style="font-family: 宋体;">　　不要。</span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;">2.<span style="font-family: 宋体;">报文是从第一次读取才开始吗？之后报文才会不停的发送吗</span>(<span style="font-family: 宋体;">既然我不</span><span style="font-family: Calibri;">read</span>)<span style="font-family: 宋体;">？</span></span></p>
<p class="15">　　&nbsp;EtherCAT<span style="font-family: 宋体;">主站协议栈会根据设定的</span><span style="font-family: Calibri;">Freerun cycle</span><span style="font-family: 宋体;">时间，自动发送数据</span><span style="font-family: 宋体;">。</span><span style="font-family: 宋体;">应用程序写了</span><span style="font-family: 宋体;">什么</span><span style="font-family: 宋体;">数据，那么主站协议栈就会发送什么数据。如果应用程序没有写数据，那么主站协议栈就发送上个周期的数据。比如，</span><span style="font-family: 宋体;">当前</span><span style="font-family: 宋体;">周期</span><span style="font-family: 宋体;">，应用</span><span style="font-family: 宋体;">程序写了</span>0x11<span style="font-family: 宋体;">，那么主站协议栈就发送</span><span style="font-family: Calibri;">0x11</span><span style="font-family: 宋体;">。如果</span><span style="font-family: 宋体;">隔了</span>5<span style="font-family: 宋体;">个</span><span style="font-family: 宋体;">周期，应用程序才写新的数据</span>0x22<span style="font-family: 宋体;">，</span><span style="font-family: 宋体;">那么在间隔的这</span>5<span style="font-family: 宋体;">个</span><span style="font-family: 宋体;">周期，主站协议栈</span><span style="font-family: 宋体;">还是</span><span style="font-family: 宋体;">发送</span>0x11<span style="font-family: 宋体;">。</span></p>
<p class="15">&nbsp;</p>
<p class="15"><span style="color: #ff0000;">3.<span style="font-family: 宋体;">循环周期可控吗？图中的</span>&rdquo;Freerun cycle&rdquo;<span style="font-family: 宋体;">指的是当前循环周期吗？如果不是它指的是最大循环周期还是最小循环周期？</span></span></p>
<p class="15"><span style="font-family: 宋体;">　　<img src="https://img2018.cnblogs.com/blog/1347181/201902/1347181-20190214094212809-211074122.png" alt="" /></span></p>
<p class="15">　　<span style="font-family: 宋体;">这个是总线循环周期，设定好之后，应用程序无法更改。赫优讯提供的</span><span style="font-family: Calibri;">EtherCAT</span><span style="font-family: 宋体;">主站的最小循环周期是</span>250us<span style="font-family: 宋体;">。最大周期不要超过</span><span style="font-family: Calibri;">5000us</span><span style="font-family: 宋体;">。</span></p>
<p class="15"><span style="font-family: 宋体;">　　简单理解，</span><span style="font-family: 宋体;">总线循环周期，就是</span>EtherCAT<span style="font-family: 宋体;">主站协议栈每次发送</span><span style="font-family: Calibri;">IO</span><span style="font-family: 宋体;">数据的数据间隔。</span></p>
<p class="15">　　<img src="https://img2018.cnblogs.com/blog/1347181/201902/1347181-20190214094246505-693103652.png" alt="" /></p>
<p>　　<img src="https://img2018.cnblogs.com/blog/1347181/201902/1347181-20190214094250123-715079023.png" alt="" /></p>
<p>&nbsp;</p>
<p class="15"><span style="color: #ff0000;">4.<span style="font-family: 宋体;">如果从站数量不变，</span>&rdquo;Freerun cycle&rdquo;<span style="font-family: 宋体;">设置甚至过小或者过大会怎么样？会有警告吗？</span></span></p>
<p class="15">　　<span style="font-family: 宋体;">设置</span><span style="font-family: 宋体;">过小，会丢包。</span><span style="font-family: 宋体;">在</span><span style="font-family: 宋体;">双端口内存的偏移地址</span>0x032D<span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">bErrorPDInCnt</span><span style="font-family: 宋体;">会有</span><span style="font-family: 宋体;">计数。</span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;">5../ build_install_driver<span style="font-family: 宋体;">和图中步骤执行的结果是相同的吗？</span></span></p>
<p class="15">　　&nbsp;<img src="https://img2018.cnblogs.com/blog/1347181/201902/1347181-20190214094336625-184781885.png" alt="" /></p>
<p>　　<span style="font-family: 宋体;">一样。</span></p>
<p>&nbsp;</p>
<p class="15"><span style="color: #ff0000;">&nbsp;6.<span style="font-family: 宋体;">每次上电都只能通过</span>./ build_install_dr<span style="font-family: 宋体;">。</span><span style="font-family: Calibri;">iver</span><span style="font-family: 宋体;">来安装驱动和加载各种配置文件吗？</span></span></p>
<p><span style="font-family: 宋体;">　　驱动</span><span style="font-family: 宋体;">安装</span><span style="font-family: 宋体;">好</span><span style="font-family: 宋体;">了之后，接下去只要运行</span><span style="font-family: 宋体;">例子</span><span style="font-family: 宋体;">程序就可以了。</span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;">&nbsp;7.<span style="font-family: 宋体;">目前是否支持热插拔？支持的话如何实现？(貌似最新版本的SYCON.net已经支持，有待确认)</span></span></p>
<p class="15"><span style="font-family: 宋体;">　　参看</span> <span style="font-family: 宋体;">文档</span>EtherCAT Master V4 Protocol API 05 EN.pdf</p>
<p class="15"><span style="font-family: 宋体;">　　赫优讯提供的</span>EtherCAT<span style="font-family: 宋体;">主站</span><span style="font-family: 宋体;">协议栈是支持</span>Hot Connect<span style="font-family: 宋体;">这个功能的，但是目前</span><span style="font-family: 宋体;">版本</span><span style="font-family: 宋体;">的</span>SYCON.net<span style="font-family: 宋体;">不能</span><span style="font-family: 宋体;">支持</span>Hot Connect<span style="font-family: 宋体;">的</span><span style="font-family: 宋体;">配置，需要使用</span>ENI<span style="font-family: 宋体;">文件</span><span style="font-family: 宋体;">（该</span><span style="font-family: 宋体;">文件也是</span><span style="font-family: 宋体;">配置文件，</span><span style="font-family: 宋体;">是</span><span style="font-family: 宋体;">由</span>EtherCAT Configurator<span style="font-family: 宋体;">生成，这个软件是</span><span style="font-family: Calibri;">Beckhoff</span><span style="font-family: 宋体;">公司的）。也</span><span style="font-family: 宋体;">就是</span><span style="font-family: 宋体;">使用</span>ENI<span style="font-family: 宋体;">文件</span><span style="font-family: 宋体;">替换</span>SYCON.net<span style="font-family: 宋体;">生成</span><span style="font-family: 宋体;">的</span>config.nxd<span style="font-family: 宋体;">文件</span><span style="font-family: 宋体;">。</span></p>